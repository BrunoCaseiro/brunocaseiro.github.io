---
layout: single
title:  "CVE-2025-26091"
header:
  overlay_image: /assets/images/banner.jpg
  show_overlay_excerpt: false
---

## Stored XSS on TeamPasswordManager

TeamPasswordManager is a password manager (surprise!) written by a single developer, Ferran Barba. You can read more about it <a href="https://teampasswordmanager.com/about/">here</a>.

An XSS vulnerability exists in TeamPasswordManager <= 12.162.284 that could allow a remote attacker to execute arbitrary JavaScript in the web browser of a user, by including a malicious payload into the 'name' parameter when creating a new password in the "My Passwords" page.

To fix the vulnerability, simply update your version of TeamPasswordManager.

This is the story of how this CVE was discovered during an internal pentest.

## Welcome to TeamPasswordManager

Let's start by taking a look at the application.

It's a pretty standard password manager and most inputs were protected against XSS. Below is an example of some attempts, and how the application properly encodes special characters.

<p align="center">
  <img src="https://github.com/user-attachments/assets/57d82af2-1ce1-49b1-a69c-f403f87571f5" width="60%">
</p>

<p align="center" style="display: flex; justify-content: center; gap: 10px;">
  <img src="https://github.com/user-attachments/assets/16cc0986-b796-4c00-bc64-64077c930a32" width="45%">
  <img src="https://github.com/user-attachments/assets/240e5dcd-943d-4642-888f-255164d6d348" width="45%" height="45%>
</p>


There was one interesting behavior when adding a personal password. For now, let's just take a look at how a user would add a password to their personal password list.

You start by pressing "New Password".

<p align="center">
  <img src="https://github.com/user-attachments/assets/5c2886b6-0b89-4acf-895e-a2923a155db4" width="60%">
</p>

You fill in the form... Let's ignore the notes thing for now :)
<p align="center">
  <img src="https://github.com/user-attachments/assets/84c66acd-5e06-4120-a9b4-df7a1852c02f" width="40%">
</p>

The password is added to your passwords. Once again, the payload _seems_ to be properly encoded!
<p align="center" style="display: flex; justify-content: center; gap: 10px;">
  <img src="https://github.com/user-attachments/assets/50f5c758-061b-4579-bf0f-2561c934336b" width="45%">
  <img src="https://github.com/user-attachments/assets/ad94ce89-3a76-456d-982d-68451fb4021d" width="45%" height="45%">
</p>


## The odd one out

If you take anything from this post, here's what it should be: just because most fields are properly sanitized, do not assume all of them are.

When going to the "Notes" tab, the special characters in the title are not properly encoded anymore. The XSS still doesn't trigger because browsers will only expect plain text inside the **\<title\>** tags.

<p align="center" style="display: flex; justify-content: center; gap: 10px;">
  <img src="https://github.com/user-attachments/assets/25abd365-eaf4-40d6-a538-f56e86aa3636" width="45%">
  <img src="https://github.com/user-attachments/assets/4f8ab202-cdc2-42c8-ae33-ebdaf8d21404" width="45%" height="45%">
</p>

So the payload requires a small tweak! _Note_ <sup>sorry</sup> how this new payload closes the **\<title\>** tag first.

<p align="center">
  <img src="https://github.com/user-attachments/assets/b42f25c8-ea84-4886-b217-30dac1644136" width="40%">
</p>

If we look at the response, it's exactly what you're expecting.

<p align="center" style="display: flex; justify-content: center; gap: 10px;">
  <img src="https://github.com/user-attachments/assets/f3b0741c-cce9-43f3-b438-26a321451160" width="40%" height="40%">
  <img src="https://github.com/user-attachments/assets/26a79519-970e-4f63-8484-2b424a48786e" width="55%">
</p>

And now for the bad news... This is only a self-XSS. Remember how this only happens when adding passwords to "My Passwords"? :(


## Possible escalation scenarios

Either way, let's explore some scenarios that could turn this self-XSS into something more dangerous. One is easy, CSRF!

Well, not really. A session-based CSRF token is provided, and this is checked when creating the password with the payload. So no luck here.

<p align="center">
  <img src="https://github.com/user-attachments/assets/a06aaa2e-7bbf-42e9-af88-e61709ad14db">
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/acc6e9c7-5fc0-444b-a9ec-d0480c457c92">
</p>


This one requires some creativity, but with a bit of social engineering this could work. There is an import/export feature. You can export your "My Passwords", send the file to someone else and have them import the file.

Luckily, there isn't any kind of validation when doing the import or export operations. Below is how you would export a .csv with your passwords, and what the file looks like

<p align="center">
  <img src="https://github.com/user-attachments/assets/0ccf8158-7cf2-47b8-ae02-4828bdcd4b23">
</p>
<p align="center">
  <img src="https://github.com/user-attachments/assets/7f7f7ef4-e1ba-4c47-b32e-7b72676b7ce9">
</p>


## Timeline

**24th Jan 2025:** Reported the vulnerability internally and forwarded it to the vendor
**27th Jan 2025:** Vulnerability was fixed and a patch was released
**27th Jan 2025:** Requested CVE ID from MITRE
**27th Feb 2025:** MITRE replies with a CVE ID I can use
**24th Jan 2025:** Wrote this post and requested CVE to be published

